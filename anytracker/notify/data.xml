<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <!--Email template for ticket creation -->
        <record id="email_template_ticket_created" model="email.template">
            <field name="name">Anytracker ticket created</field>
            <field name="email_from">${user.user_email}</field>
            <field name="subject">New ticket #${object.number} created by ${user.name} in Anytracker</field>
            <field name="email_to">${str([str(i.user_email) for i in object.project_id.participant_ids if i.user_email])[1:-1].replace("'",'')}</field>
            <field name="model_id" ref="anytracker.model_anytracker_ticket"/>
            <field name="lang">${user.context_lang}</field>
            <field name="auto_delete" eval="True"/>
            <field name="body_text"><![CDATA[Ticket #${object.number} is now in stage ${object.stage_id.name}


${object.name}
--
${object.description}
            ]]></field>
        </record>
        <!-- put the template at least on one stage, but disabled by default -->
        <record id="stage_maintenance_new" model="anytracker.stage">
            <field name="notify" eval="0"/>
            <field name="notify_template_id" ref="anytracker.email_template_ticket_created"/>
            <field name="notify_urgent" eval="1"/>
        </record>

        <!--Email template for stage change-->
        <record id="email_template_ticket_modified" model="email.template">
            <field name="name">Anytracker ticket modified</field>
            <field name="email_from">${user.user_email}</field>
            <field name="subject">Anytracker ticket #${object.number} stage modified by ${user.name}</field>
            <field name="email_to">${str([str(i.user_email) for i in object.project_id.participant_ids if i.user_email])[1:-1].replace("'",'')}</field>
            <field name="model_id" ref="anytracker.model_anytracker_ticket"/>
            <field name="lang">${user.context_lang}</field>
            <field name="auto_delete" eval="True"/>
            <field name="body_text"><![CDATA[Ticket #${object.number} is now in stage ${object.stage_id.name}


${object.name}
--
${object.description}
            ]]></field>
        </record>
        <!-- put the template at least on one stage, but disabled by default -->
        <record id="stage_maintenance_ack" model="anytracker.stage">
            <field name="notify" eval="0"/>
            <field name="notify_template_id" ref="anytracker.email_template_ticket_modified"/>
            <field name="notify_urgent" eval="0"/>
        </record>

    </data>
</openerp>
